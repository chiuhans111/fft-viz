(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))e(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const h of a.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&e(h)}).observe(document,{childList:!0,subtree:!0});function s(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function e(i){if(i.ep)return;i.ep=!0;const a=s(i);fetch(i.href,a)}})();const b=1-.7952295855142201;function F(n){const t=1-n*b,s=t-t/Math.sqrt(2);let e=n;return[e*.24537586511865822+(1-e)*.26512268687055385,e*.23315123245977887+(1-e)*.18747047774458375,s]}function N(n,t){const s=n;return[[t,0],[t*(1-s[0]),0],[t*(s[2]+s[1]),t*(s[2]-s[1])],[t*s[2],t*s[2]]]}function d(n,t){return`${n.toFixed(2)} ${t.toFixed(2)}`}function y(n,t,s,e,i){s<.001&&(s=.001),e<.001&&(e=.001),i=Math.min(s/2,e/2,i);const a=(s/2-i)/(s/2),h=(e/2-i)/(e/2),f=Math.min(1,a/b),o=Math.min(1,h/b),l=F(f),m=F(o),r=i/(1-f*b),p=i/(1-o*b),c=N(l,r),u=N(m,p);return["M "+d(n,t+u[0][0]),"C "+d(n+u[1][1],t+u[1][0])+","+d(n+u[2][1],t+u[2][0])+","+d(n+u[3][1],t+u[3][0]),"C "+d(n+c[2][0],t+c[2][1])+","+d(n+c[1][0],t+c[1][1])+","+d(n+c[0][0],t+c[0][1]),"L "+d(n+s/2,t),"L "+d(n+s-c[0][0],t),"C "+d(n+s-c[1][0],t+c[1][1])+","+d(n+s-c[2][0],t+c[2][1])+","+d(n+s-c[3][0],t+c[3][1]),"C "+d(n+s-u[2][1],t+u[2][0])+","+d(n+s-u[1][1],t+u[1][0])+","+d(n+s,t+u[0][0]),"L "+d(n+s,t+e/2),"L "+d(n+s,t+e-u[0][0]),"C "+d(n+s-u[1][1],t+e-u[1][0])+","+d(n+s-u[2][1],t+e-u[2][0])+","+d(n+s-u[3][1],t+e-u[3][0]),"C "+d(n+s-c[2][0],t+e-c[2][1])+","+d(n+s-c[1][0],t+e-c[1][1])+","+d(n+s-c[0][0],t+e),"L "+d(n+s/2,t+e),"L "+d(n+c[0][0],t+e),"C "+d(n+c[1][0],t+e-c[1][1])+","+d(n+c[2][0],t+e-c[2][1])+","+d(n+c[3][0],t+e-c[3][1]),"C "+d(n+u[2][1],t+e-u[2][0])+","+d(n+u[1][1],t+e-u[1][0])+","+d(n,t+e-u[0][0]),"L "+d(n,t+e/2),"Z"].join(" ")}function $(n,t,s,e,i,a){s<.001&&(s=.001),e<.001&&(e=.001),i=Math.min(s/2,e/2,i);const h=s-i*2,f=e-i*2,o=i*2*Math.PI/4,l=h*2+f*2+o*4;a=(a+1)%1;let m=a*l;const r=[[f/2,"y",n+s,t+e/2,0,-1],[o,"c",n+s-i,t+i,0,0],[h,"x",n+s-i,t,-1,0],[o,"c",n+i,t+i,Math.PI/2,0],[f,"y",n,t+i,0,1],[o,"c",n+i,t+e-i,Math.PI,0],[h,"x",n+i,t+e,1,0],[o,"c",n+s-i,t+e-i,3*Math.PI/2,0],[f/2,"y",n+s,t+e-i,0,-1]];for(let p=0;p<r.length;p++){const[c,u,j,_,w,g]=r[p];if(m<=c){if(u==="x"||u==="y")return{x:j+m*w,y:_+m*g};if(u==="c"){const M=w+m/c*(Math.PI/2);return{x:j+i*Math.cos(M),y:_-i*Math.sin(M)}}}m-=c}return{x:n,y:t}}class v{constructor(t,s=1,e=1,i=1){this.target=t,this.value=t,this.previous_value=t,this.mass=s,this.spring=e,this.damping_ratio=i,this.acceleration=0,this.solveEquation()}solveEquation(){const t=this.mass,s=this.spring,e=Math.sqrt(4*t*s)*this.damping_ratio;this.l1=-e/2/t,this.l2=Math.sqrt(Math.abs(this.l1**2-s/t)),this.underdamp=e<Math.sqrt(4*t*s)}getCoeff(t){if(this.underdamp){const s=Math.exp(this.l1*t)*Math.cos(this.l2*t)*2,e=Math.exp(2*this.l1*t);return[s,e]}else{const s=Math.exp((this.l1+this.l2)*t)+Math.exp((this.l1-this.l2)*t),e=Math.exp(2*this.l1*t);return[s,e]}}set(t){this.value=t,this.target=t,this.previous_value=t}update(t=16){const[s,e]=this.getCoeff(t);let i=this.previous_value-this.target-this.acceleration*t;this.previous_value=this.value;let a=this.value-this.target,h=s*a-e*i;this.value=h+this.target,this.acceleration=0}update_modulo(t=16,s=1){const[e,i]=this.getCoeff(t);let a=this.previous_value-this.target-this.acceleration*t;this.previous_value=this.value;let h=this.value-this.target;for(;h<-s/2;)h+=s;for(;h>s/2;)h-=s;for(Math.abs(h)>.01&&h<0&&h*a<0&&(h+=s);a-h<-s/2;)a+=s;for(;a-h>s/2;)a-=s;let f=e*h-i*a;this.value=f+this.target,this.acceleration=0}}function q(n,t,s){return s<0&&(s+=1),s>1&&(s-=1),s<1/6?n+(t-n)*6*s:s<1/2?t:s<2/3?n+(t-n)*(2/3-s)*6:n}function O(n,t,s){n=n%1;let e,i,a;{const h=s+t-s*t,f=2*s-h;e=q(f,h,n+1/3),i=q(f,h,n),a=q(f,h,n-1/3)}return[Math.round(e*255),Math.round(i*255),Math.round(a*255)]}const k=document.querySelector("svg"),x="http://www.w3.org/2000/svg";class L{constructor(t,s,e,i,a){this.g=document.createElementNS(x,"g"),this.g.style.willChange="transform",k.append(this.g),this.path=document.createElementNS(x,"path"),this.path.setAttribute("fill","black"),this.path.style.pointerEvents="none",this.g.append(this.path),this.text=document.createElementNS(x,"text"),this.text.textContent="",this.text.setAttribute("fill","white"),this.text.setAttribute("font-family","inter"),this.text.setAttribute("text-anchor","middle"),this.text.setAttribute("font-size","3"),this.text.setAttribute("dominant-baseline","central"),this.text.setAttribute("alignment-baseline"," central"),this.text.style.pointerEvents="none",this.g.append(this.text),this.x=new v(t,1,1,.6),this.y=new v(s,1,1,1),this.w=new v(e,1,1,1),this.h=new v(i,1,1,1),this.r=new v(a,1,1,1),this.show=new v(1,1,1,1),this.show.value=0,this.childs=[],this.margin=new v(1,1,1,1)}update(t){if(this.show.update(t),this.childs.length){let s=this.childs[0].x.value-this.childs[0].w.value/2,e=this.childs[0].x.value+this.childs[0].w.value/2,i=this.childs[0].y.value-this.childs[0].h.value/2,a=this.childs[0].y.value+this.childs[0].h.value/2;for(let h=1;h<this.childs.length;h++)s=Math.min(s,this.childs[h].x.value-this.childs[0].w.value/2),e=Math.max(e,this.childs[h].x.value+this.childs[0].w.value/2),i=Math.min(i,this.childs[h].y.value-this.childs[0].h.value/2),a=Math.max(a,this.childs[h].y.value+this.childs[0].h.value/2);this.x.set((s+e)/2),this.y.set((i+a)/2),this.w.set(e-s+this.margin.value*2),this.h.set(a-i+this.margin.value*2)}else this.x.update(t),this.y.update(t),this.w.update(t),this.h.update(t),this.r.update(t);this.path.setAttribute("d",y(-this.w.value/2,-this.h.value/2,this.w.value,this.h.value,this.r.value)),this.g.setAttribute("transform",`translate(${this.x.value.toFixed(2)}, ${this.y.value.toFixed(2)})`),this.g.setAttribute("opacity",this.show.value.toFixed(2)),this.text.getBBox()}}class E extends L{constructor(t,s,e,i,a,h){super(t,s,e,i,a),this.time=new v(0,1,1,.8),this.time.target=h,this.time_hand_g=document.createElementNS(x,"g"),this.time_hand=document.createElementNS(x,"path"),this.time_hand.setAttribute("fill","white"),this.g.append(this.time_hand_g),this.time_hand_g.append(this.time_hand),this.time_hand_fac=new v(0,1,2,.7),this.time_hand.style.pointerEvents="none",this.interact=!1}interactible(t){let s=this;this.interact=!0,this.text.textContent=t,this.path.style.pointerEvents="",this.path.addEventListener("mouseenter",function(){s.time_hand_fac.target=1}),this.path.addEventListener("mouseleave",function(){s.time_hand_fac.target=0})}update(t){super.update(t),this.time.update_modulo(t),this.time_hand_fac.update(t);const s=.5;let e=(this.time.value+.5)%1-.5;e=1-e;const i=$(this.x.value-this.w.value/2,this.y.value-this.h.value/2,this.w.value,this.h.value,this.r.value,e),a=Math.sqrt((i.x-this.x.value)**2+(i.y-this.y.value)**2),h=Math.atan2(i.y-this.y.value,i.x-this.x.value);this.time_hand_g.setAttribute("transform",`rotate(${(h*180/Math.PI).toFixed(2)})`),this.time_hand.setAttribute("d",y(a*this.time_hand_fac.value-s/2,-.5/2,Math.max(s,(a-s)*(1-this.time_hand_fac.value)+this.time_hand_fac.value*s),s,s));const f="rgb("+O(this.time.value,.65,.55).join(",")+")";this.path.setAttribute("fill",f),this.time_hand.setAttribute("stroke",f),this.time_hand.setAttribute("stroke-width",s*2),this.time_hand.setAttribute("paint-order","stroke"),this.path.setAttribute("stroke-width",s*Math.max(0,this.time_hand_fac.value.toFixed(2))),this.path.setAttribute("stroke",f),this.path.setAttribute("fill-opacity",(1-this.time_hand_fac.value).toFixed(2)),this.interact&&(this.text.setAttribute("fill",f),this.text.setAttribute("opacity",this.time_hand_fac.value.toFixed(2)))}}const z=document.getElementById("bg"),B=document.querySelector("svg");class P{constructor(t,s,e,i,a,h){this.inputs=t,this.outputs=s,this.matrix=e,this.radices=i,this.j2dn=a,this.i2j2dn2=h;const f=e.length;if(this.n0=f,this.childs=[],this.n2=0,this.radices.length>0){const o=i[0],l=Math.floor(f/o);this.n2=o;for(let m=0;m<o;m++){let r=[];for(let p=0;p<o;p++){const c=[],u=[],j=[];for(let _=0;_<l;_++){let w=_+m*l,g=_*o+p;c.push(t[g]),u.push(s[w])}for(let _=0;_<l;_++){const w=[];for(let g=0;g<l;g++){let M=_+m*l,S=g*o+p;w.push(e[M][S])}j.push(w)}r.push(new P(c,u,j,i.slice(1),p/f,m*p/o))}this.childs.push(r)}}this.i1j2dn_wrappers=[];for(let o=0;o<f;o++){if(a*o==0){this.i1j2dn_wrappers.push(null);continue}this.i1j2dn_wrappers.push(new E(0,0,0,0,4.65,0)),this.i1j2dn_wrappers[o].show.set(0),this.i1j2dn_wrappers[o].time_hand_fac.set(1),this.i1j2dn_wrappers[o].margin.set(.65),this.i1j2dn_wrappers[o].time.mass=f,this.i1j2dn_wrappers[o].time.solveEquation();for(let l=0;l<f;l++)this.i1j2dn_wrappers[o].childs.push(e[o][l])}if(this.i2j2dn2_wrapper=null,h!=0){this.i2j2dn2_wrapper=new E(1,1,1,1,5.5,0),this.i2j2dn2_wrapper.show.set(0),this.i2j2dn2_wrapper.time_hand_fac.set(1),this.i2j2dn2_wrapper.margin.set(1.5),this.i2j2dn2_wrapper.time.mass=f,this.i2j2dn2_wrapper.time.solveEquation();for(let o=0;o<f;o++)for(let l=0;l<f;l++)this.i2j2dn2_wrapper.childs.push(e[o][l])}this.bg_wrapper=new L(1,1,1,1,5.6),this.bg_wrapper.margin.set(1.6);for(let o=0;o<f;o++)for(let l=0;l<f;l++)this.bg_wrapper.childs.push(e[o][l]);this.bg_wrapper.path.setAttribute("fill","white"),z.appendChild(this.bg_wrapper.g),this.timeouts=[]}update(t){const s=this.n0,e=this.n2;for(let i=0;i<s;i++)this.i1j2dn_wrappers[i]!=null&&this.i1j2dn_wrappers[i].update(t);this.i2j2dn2_wrapper!=null&&this.i2j2dn2_wrapper.update(t);for(let i=0;i<e;i++)for(let a=0;a<e;a++)this.childs[i][a].update(t);this.bg_wrapper.update(t)}clear_state(){for(;this.timeouts.length;)clearTimeout(this.timeouts.pop());const t=this.n0,s=this.n2;for(let e=0;e<t;e++)this.i1j2dn_wrappers[e]!=null&&(this.i1j2dn_wrappers[e].show.target=0);this.i2j2dn2_wrapper!=null&&(this.i2j2dn2_wrapper.show.target=0);for(let e=0;e<s;e++)for(let i=0;i<s;i++)this.childs[e][i].clear_state();this.bg_wrapper.show.target=0}layout(t,s=0,e=0,i=0,a=!0){a&&this.clear_state(),this.n0;const h=this.matrix,f=this.j2dn,o=this.i2j2dn2;if(t>0){const l=this.n2;let m=e,r=0;for(let p=0;p<l;p++){let c=s;for(let u=0;u<l;u++)r=this.childs[p][u].layout(t-1,c,m,i+u*200/l+p*100/l,!1),c+=r;m+=r}return this.n2*r}else{this.bg_wrapper.show.target=1;const l=this.n0;for(let r=0;r<l;r++)this.timeouts.push(setTimeout(()=>{this.inputs[r].x.target=r*10+s,this.outputs[r].y.target=r*10+e},i+=r*10));for(let r=0;r<l;r++)for(let p=0;p<l;p++)this.timeouts.push(setTimeout(()=>{h[r][p].x.target=p*10+s,h[r][p].y.target=r*10+e,h[r][p].time.target=r*p/l+f*r+o},i+=10));let m=!1;for(let r=0;r<l;r++)this.i1j2dn_wrappers[r]!=null&&(this.timeouts.push(setTimeout(()=>{this.i1j2dn_wrappers[r].time_hand_fac.set(1),this.i1j2dn_wrappers[r].time.set(0),this.i1j2dn_wrappers[r].show.target=1},i)),i+=200,m=!0),this.timeouts.push(setTimeout(()=>{this.i1j2dn_wrappers[r]!=null&&(this.i1j2dn_wrappers[r].time.target=-f*r);for(let p=0;p<l;p++)h[r][p].time.target=r*p/l+o},i+500));return m&&(i+=600),this.i2j2dn2_wrapper!=null&&(this.timeouts.push(setTimeout(()=>{this.i2j2dn2_wrapper.time.set(0),this.i2j2dn2_wrapper.show.target=1,this.i2j2dn2_wrapper.time_hand_fac.set(1)},i)),i+=500),this.timeouts.push(setTimeout(()=>{this.i2j2dn2_wrapper!=null&&(this.i2j2dn2_wrapper.time.target=-o);for(let r=0;r<l;r++)for(let p=0;p<l;p++)h[r][p].time.target=r*p/l},i)),l*12}}}class U{constructor(t){this.radices=t,this.N=t.reduce((s,e)=>s*e,1),this.inputs=[],this.outputs=[],this.matrix=[],this._initializeMatrix(),this.sub_matrix=new P(this.inputs,this.outputs,this.matrix,this.radices,0,0),this.sub_matrix.layout(0)}_initializeMatrix(){for(let t=0;t<this.N;t++){const s=new L(t*10,-12,8,8,10);this.inputs.push(s),s.text.textContent=t;const e=new L(-12,t*10,8,8,10);this.outputs.push(e),e.text.textContent=t}for(let t=0;t<this.N;t++){const s=[];for(let e=0;e<this.N;e++){const i=new E(e*10,t*10,8,8,8,t*e/this.N);i.interactible(t*e%this.N),s.push(i)}this.matrix.push(s)}B.setAttribute("viewBox",`-16 -18 ${this.N*12+12+2} ${this.N*12+12+2}`)}update(t){for(let s of this.inputs)s.update(t);for(let s of this.outputs)s.update(t);for(let s of this.matrix)for(let e of s)e.update(t);this.sub_matrix.update(t)}}let T=0;function D(){const t=new URLSearchParams(window.location.search).get("fftParams");if(t){console.log(t);try{const s=t.split(",").map(e=>parseInt(e));return console.log(s),s}catch(s){console.error("Invalid fftParams in URL:",s)}}return[2,2,1]}const K=D(),A=new U(K),Z=[A];function I(n){requestAnimationFrame(I);let t=(n-T)/100;t=Math.min(t,1),T=n;for(let s of Z)s.update(t)}requestAnimationFrame(I);let C=1;document.addEventListener("mousedown",function(){A.sub_matrix.layout(C%A.radices.length),C=C+1%A.radices.length});
